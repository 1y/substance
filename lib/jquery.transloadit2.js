/*
 jQuery Easing v1.3: Copyright (c) 2008 George McGinley Smith | BSD License: http://www.opensource.org/licenses/bsd-license.php
 jQuery JSONP Core Plugin 2.1.2: Copyright (c) 2010 Julian Aubourg | MIT License: http://www.opensource.org/licenses/mit-license.php
 json2: Douglas Crockford | Public domain
 jQuery Tools 1.2.3: Tero Piirainen | Public domain
 jquery.transloadit2.js: Copyright (c) 2010 Felix Geisend√∂rfer | MIT License: http://www.opensource.org/licenses/mit-license.php

 Fork this on Github: http://github.com/transloadit/jquery-sdk
*/
jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(b,a,g,e,f){return jQuery.easing[jQuery.easing.def](b,a,g,e,f)},easeInQuad:function(b,a,g,e,f){return e*(a/=f)*a+g},easeOutQuad:function(b,a,g,e,f){return-e*(a/=f)*(a-2)+g},easeInOutQuad:function(b,a,g,e,f){if((a/=f/2)<1)return e/2*a*a+g;return-e/2*(--a*(a-2)-1)+g},easeInCubic:function(b,a,g,e,f){return e*(a/=f)*a*a+g},easeOutCubic:function(b,a,g,e,f){return e*((a=a/f-1)*a*a+1)+g},easeInOutCubic:function(b,a,g,e,f){if((a/=f/2)<1)return e/
2*a*a*a+g;return e/2*((a-=2)*a*a+2)+g},easeInQuart:function(b,a,g,e,f){return e*(a/=f)*a*a*a+g},easeOutQuart:function(b,a,g,e,f){return-e*((a=a/f-1)*a*a*a-1)+g},easeInOutQuart:function(b,a,g,e,f){if((a/=f/2)<1)return e/2*a*a*a*a+g;return-e/2*((a-=2)*a*a*a-2)+g},easeInQuint:function(b,a,g,e,f){return e*(a/=f)*a*a*a*a+g},easeOutQuint:function(b,a,g,e,f){return e*((a=a/f-1)*a*a*a*a+1)+g},easeInOutQuint:function(b,a,g,e,f){if((a/=f/2)<1)return e/2*a*a*a*a*a+g;return e/2*((a-=2)*a*a*a*a+2)+g},easeInSine:function(b,
a,g,e,f){return-e*Math.cos(a/f*(Math.PI/2))+e+g},easeOutSine:function(b,a,g,e,f){return e*Math.sin(a/f*(Math.PI/2))+g},easeInOutSine:function(b,a,g,e,f){return-e/2*(Math.cos(Math.PI*a/f)-1)+g},easeInExpo:function(b,a,g,e,f){return a==0?g:e*Math.pow(2,10*(a/f-1))+g},easeOutExpo:function(b,a,g,e,f){return a==f?g+e:e*(-Math.pow(2,-10*a/f)+1)+g},easeInOutExpo:function(b,a,g,e,f){if(a==0)return g;if(a==f)return g+e;if((a/=f/2)<1)return e/2*Math.pow(2,10*(a-1))+g;return e/2*(-Math.pow(2,-10*--a)+2)+g},
easeInCirc:function(b,a,g,e,f){return-e*(Math.sqrt(1-(a/=f)*a)-1)+g},easeOutCirc:function(b,a,g,e,f){return e*Math.sqrt(1-(a=a/f-1)*a)+g},easeInOutCirc:function(b,a,g,e,f){if((a/=f/2)<1)return-e/2*(Math.sqrt(1-a*a)-1)+g;return e/2*(Math.sqrt(1-(a-=2)*a)+1)+g},easeInElastic:function(b,a,g,e,f){b=1.70158;var c=0,d=e;if(a==0)return g;if((a/=f)==1)return g+e;c||(c=f*0.3);if(d<Math.abs(e)){d=e;b=c/4}else b=c/(2*Math.PI)*Math.asin(e/d);return-(d*Math.pow(2,10*(a-=1))*Math.sin((a*f-b)*2*Math.PI/c))+g},easeOutElastic:function(b,
a,g,e,f){b=1.70158;var c=0,d=e;if(a==0)return g;if((a/=f)==1)return g+e;c||(c=f*0.3);if(d<Math.abs(e)){d=e;b=c/4}else b=c/(2*Math.PI)*Math.asin(e/d);return d*Math.pow(2,-10*a)*Math.sin((a*f-b)*2*Math.PI/c)+e+g},easeInOutElastic:function(b,a,g,e,f){b=1.70158;var c=0,d=e;if(a==0)return g;if((a/=f/2)==2)return g+e;c||(c=f*0.3*1.5);if(d<Math.abs(e)){d=e;b=c/4}else b=c/(2*Math.PI)*Math.asin(e/d);if(a<1)return-0.5*d*Math.pow(2,10*(a-=1))*Math.sin((a*f-b)*2*Math.PI/c)+g;return d*Math.pow(2,-10*(a-=1))*Math.sin((a*
f-b)*2*Math.PI/c)*0.5+e+g},easeInBack:function(b,a,g,e,f,c){if(c==undefined)c=1.70158;return e*(a/=f)*a*((c+1)*a-c)+g},easeOutBack:function(b,a,g,e,f,c){if(c==undefined)c=1.70158;return e*((a=a/f-1)*a*((c+1)*a+c)+1)+g},easeInOutBack:function(b,a,g,e,f,c){if(c==undefined)c=1.70158;if((a/=f/2)<1)return e/2*a*a*(((c*=1.525)+1)*a-c)+g;return e/2*((a-=2)*a*(((c*=1.525)+1)*a+c)+2)+g},easeInBounce:function(b,a,g,e,f){return e-jQuery.easing.easeOutBounce(b,f-a,0,e,f)+g},easeOutBounce:function(b,a,g,e,f){return(a/=
f)<1/2.75?e*7.5625*a*a+g:a<2/2.75?e*(7.5625*(a-=1.5/2.75)*a+0.75)+g:a<2.5/2.75?e*(7.5625*(a-=2.25/2.75)*a+0.9375)+g:e*(7.5625*(a-=2.625/2.75)*a+0.984375)+g},easeInOutBounce:function(b,a,g,e,f){if(a<f/2)return jQuery.easing.easeInBounce(b,a*2,0,e,f)*0.5+g;return jQuery.easing.easeOutBounce(b,a*2-f,0,e,f)*0.5+e*0.5+g}});
(function(b,a){function g(){}function e(l){F=[l]}function f(l,y,z){return l&&l.apply(y.context||y,z)}function c(l){function y(o){!A++&&a(function(){C();D&&(G[t]={s:[o]});J&&(o=J.apply(l,[o]));f(l.success,l,[o,n]);f(K,l,[l,n])},0)}function z(o){!A++&&a(function(){C();D&&o!=L&&(G[t]=o);f(l.error,l,[l,o]);f(K,l,[l,o])},0)}l=b.extend({},M,l);var K=l.complete,J=l.dataFilter,N=l.callbackParameter,O=l.callback,T=l.cache,D=l.pageCache,P=l.charset,t=l.url,w=l.data,Q=l.timeout,E,A=0,C=g;l.abort=function(){!A++&&
C()};if(f(l.beforeSend,l,[l])===false||A)return l;t=t||q;w=w?typeof w=="string"?w:b.param(w,l.traditional):q;t+=w?(/\?/.test(t)?"&":"?")+w:q;N&&(t+=(/\?/.test(t)?"&":"?")+escape(N)+"=?");!T&&!D&&(t+=(/\?/.test(t)?"&":"?")+"_"+(new Date).getTime()+"=");t=t.replace(/=\?(&|$)/,"="+O+"$1");D&&(E=G[t])?E.s?y(E.s[0]):z(E):a(function(o,B,H){if(!A){H=Q>0&&a(function(){z(L)},Q);C=function(){H&&clearTimeout(H);o[v]=o[k]=o[s]=o[m]=null;x[u](o);B&&x[u](B)};window[O]=e;o=b(r)[0];o.id=p+U++;if(P)o[j]=P;var R=function(I){(o[k]||
g)();I=F;F=undefined;I?y(I[0]):z(h)};if(S.msie){o.event=k;o.htmlFor=o.id;o[v]=function(){o.readyState=="loaded"&&R()}}else{o[m]=o[s]=R;S.opera?(B=b(r)[0]).text="jQuery('#"+o.id+"')[0]."+m+"()":o[d]=d}o.src=t;x.insertBefore(o,x.firstChild);B&&x.insertBefore(B,x.firstChild)}},0);return l}var d="async",j="charset",q="",h="error",p="_jqjsp",k="onclick",m="on"+h,s="onload",v="onreadystatechange",u="removeChild",r="<script/>",n="success",L="timeout",S=b.browser,x=b("head")[0]||document.documentElement,
G={},U=0,F,M={callback:p,url:location.href};c.setup=function(l){b.extend(M,l)};b.jsonp=c})(jQuery,setTimeout);if(!this.JSON)this.JSON={};
(function(){function b(h){return h<10?"0"+h:h}function a(h){f.lastIndex=0;return f.test(h)?'"'+h.replace(f,function(p){var k=j[p];return typeof k==="string"?k:"\\u"+("0000"+p.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+h+'"'}function g(h,p){var k,m,s,v,u=c,r,n=p[h];if(n&&typeof n==="object"&&typeof n.toJSON==="function")n=n.toJSON(h);if(typeof q==="function")n=q.call(p,h,n);switch(typeof n){case "string":return a(n);case "number":return isFinite(n)?String(n):"null";case "boolean":case "null":return String(n);
case "object":if(!n)return"null";c+=d;r=[];if(Object.prototype.toString.apply(n)==="[object Array]"){v=n.length;for(k=0;k<v;k+=1)r[k]=g(k,n)||"null";s=r.length===0?"[]":c?"[\n"+c+r.join(",\n"+c)+"\n"+u+"]":"["+r.join(",")+"]";c=u;return s}if(q&&typeof q==="object"){v=q.length;for(k=0;k<v;k+=1){m=q[k];if(typeof m==="string")if(s=g(m,n))r.push(a(m)+(c?": ":":")+s)}}else for(m in n)if(Object.hasOwnProperty.call(n,m))if(s=g(m,n))r.push(a(m)+(c?": ":":")+s);s=r.length===0?"{}":c?"{\n"+c+r.join(",\n"+c)+
"\n"+u+"}":"{"+r.join(",")+"}";c=u;return s}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c,d,j={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},q;if(typeof JSON.stringify!=="function")JSON.stringify=function(h,p,k){var m;d=c="";if(typeof k==="number")for(m=0;m<k;m+=1)d+=" ";else if(typeof k==="string")d=k;if((q=p)&&typeof p!=="function"&&(typeof p!=="object"||typeof p.length!=="number"))throw Error("JSON.stringify");return g("",
{"":h})};if(typeof JSON.parse!=="function")JSON.parse=function(h,p){function k(s,v){var u,r,n=s[v];if(n&&typeof n==="object")for(u in n)if(Object.hasOwnProperty.call(n,u)){r=k(n,u);if(r!==undefined)n[u]=r;else delete n[u]}return p.call(s,v,n)}var m;h=String(h);e.lastIndex=0;if(e.test(h))h=h.replace(e,function(s){return"\\u"+("0000"+s.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(h.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){m=eval("("+h+")");return typeof p==="function"?k({"":m},""):m}throw new SyntaxError("JSON.parse");}})();
(function(b){function a(){if(b.browser.msie){var h=b(document).height(),p=b(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,h-p<20?p:h]}return[b(document).width(),b(document).height()]}function g(h){if(h)return h.call(b.mask)}b.tools=b.tools||{version:"1.2.3"};var e;e=b.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:true,closeOnEsc:true,zIndex:9998,opacity:0.8,startOpacity:0,color:"#fff",onLoad:null,
onClose:null}};var f,c,d,j,q;b.mask={load:function(h,p){if(d)return this;if(typeof h=="string")h={color:h};h=h||j;j=h=b.extend(b.extend({},e.conf),h);f=b("#"+h.maskId);if(!f.length){f=b("<div/>").attr("id",h.maskId);b("body").append(f)}var k=a();f.css({position:"absolute",top:0,left:0,width:k[0],height:k[1],display:"none",opacity:h.startOpacity,zIndex:h.zIndex});h.color&&f.css("backgroundColor",h.color);if(g(h.onBeforeLoad)===false)return this;h.closeOnEsc&&b(document).bind("keydown.mask",function(m){m.keyCode==
27&&b.mask.close(m)});h.closeOnClick&&f.bind("click.mask",function(m){b.mask.close(m)});b(window).bind("resize.mask",function(){b.mask.fit()});if(p&&p.length){q=p.eq(0).css("zIndex");b.each(p,function(){var m=b(this);/relative|absolute|fixed/i.test(m.css("position"))||m.css("position","relative")});c=p.css({zIndex:Math.max(h.zIndex+1,q=="auto"?0:q)})}f.css({display:"block"}).fadeTo(h.loadSpeed,h.opacity,function(){b.mask.fit();g(h.onLoad)});d=true;return this},close:function(){if(d){if(g(j.onBeforeClose)===
false)return this;f.fadeOut(j.closeSpeed,function(){g(j.onClose);c&&c.css({zIndex:q})});b(document).unbind("keydown.mask");f.unbind("click.mask");b(window).unbind("resize.mask");d=false}return this},fit:function(){if(d){var h=a();f.css({width:h[0],height:h[1]})}},getMask:function(){return f},isLoaded:function(){return d},getConf:function(){return j},getExposed:function(){return c}};b.fn.mask=function(h){b.mask.load(h);return this};b.fn.expose=function(h){b.mask.load(h,this);return this}})(jQuery);
(function(b){function a(){this.timer=this.documentTitle=this.assemblyId=null;this._options={};this.uploads=[];this.results={};this.pollStarted=this.ended=null;this.seq=this.pollRetries=0;this.started=false;this.params=this.assembly=null;this.lastPoll=this.bytesReceivedBefore=0;this.$modal=this.$iframe=this.$fileClones=this.$files=this.$form=this.$params=null}var g=document.location.protocol=="https:"?"https://":"http://",e={service:g+"api2.transloadit.com/",assets:g+"assets.transloadit.com/",onStart:function(){},
onProgress:function(){},onUpload:function(){},onResult:function(){},onCancel:function(){},onError:function(){},onSuccess:function(){},interval:2500,wait:false,autoSubmit:true,modal:true,exclude:"",fields:false,debug:true},f=false;b.fn.transloadit=function(){var c=Array.prototype.slice.call(arguments),d;if(c.length==1&&typeof c[0]=="object"||c[0]===undefined)c.unshift("init");d=c.shift();if(d=="init"){uploader=new a;c.unshift(this);this.data("transloadit.uploader",uploader)}else uploader=this.data("transloadit.uploader");
if(!uploader)throw Error("Element is not initialized for transloadit!");c=uploader[d].apply(uploader,c);return c===undefined?this:c};a.prototype.init=function(c,d){this.$form=c;this.options(b.extend({},e,d||{}));var j=this;c.bind("submit.transloadit",function(){j.start();return false});this.includeCss()};a.prototype.start=function(){var c=this;this.ended=false;this.seq=this.pollRetries=this.bytesReceivedBefore=0;this.uploads=[];this.results={};this.assemblyId=this.uuid();var d=this.$form.find("input[name=params]");
if(d.length){try{this.params=JSON.parse(d.val())}catch(j){alert("Error: input[name=params] seems to contain invalid JSON.");return}if(this.params.redirect_url)this.$form.attr("action",this.params.redirect_url);else if(this._options.autoSubmit&&this.$form.attr("action")==this._options.service+"assemblies"){alert("Error: input[name=params] does not include a redirect_url");return}this.$files=this.$form.find("input[type=file]").not(this._options.exclude);c.$fileClones=b().not(document);this.$files.each(function(){var h=
b(this).clone();c.$fileClones=c.$fileClones.add(h);h.insertAfter(this)});this.$iframe=b('<iframe id="transloadit-'+this.assemblyId+'" name="transloadit-'+this.assemblyId+'"/>').appendTo("body").hide();this.$uploadForm=b('<form enctype="multipart/form-data" />').attr("action",this._options.service+"assemblies/"+this.assemblyId+"?redirect=false").attr("target","transloadit-"+this.assemblyId).attr("method","POST").append(this.$files).appendTo("body").hide();var q="[name=params], [name=signature]";if(this._options.fields===
true)q="*";else if(typeof this._options.fields=="string")q+=", "+this._options.fields;this.$form.find("input[type!=file]").filter(q).clone().prependTo(this.$uploadForm);this.$params=d;this.$uploadForm.submit();this.lastPoll=+new Date;setTimeout(function(){c._poll()},300);this._options.modal&&this.showModal()}else alert("Could not find input[name=params] in your form.")};a.prototype._poll=function(c){var d=this;if(!this.ended){if(b.browser.mozilla&&!this.documentTitle){this.documentTitle=document.title;
document.title="Loading..."}this.pollStarted=+new Date;b.jsonp({url:this._options.service+"assemblies/"+this.assemblyId+(c||"?seq="+this.seq),timeout:6E3,callbackParameter:"callback",success:function(j){if(!d.ended){d.assembly=j;if(j.error=="ASSEMBLY_NOT_FOUND"){d.pollRetries++;if(d.pollRetries>5){document.title=d.documentTitle;d.ended=true;d.renderError(j);d._options.onError(j)}else setTimeout(function(){d._poll()},400)}else if(j.error){d.ended=true;d.renderError(j);document.title=d.documentTitle;
d._options.onError(j)}else{d.seq=j.last_seq;if(!d.started){d.started=true;d._options.onStart(j)}d.pollRetries=0;var q=j.ok=="ASSEMBLY_EXECUTING",h=j.ok=="ASSEMBLY_CANCELED",p=j.ok=="ASSEMBLY_COMPLETED";d._options.onProgress(j.bytes_received,j.bytes_expected,j);for(var k=0;k<j.uploads.length;k++){d._options.onUpload(j.uploads[k],j);d.uploads.push(j.uploads[k])}for(var m in j.results){d.results[m]=d.results[m]||[];for(k=0;k<j.results[m].length;k++){d._options.onResult(m,j.results[m][k],j);d.results[m].push(j.results[m][k])}}if(h){d.ended=
true;document.title=d.documentTitle;d._options.onCancel(j)}else{d.renderProgress(j);if(p||!d._options.wait&&q){d.ended=true;document.title=d.documentTitle;j.uploads=d.uploads;j.results=d.results;d._options.onSuccess(j);d._options.modal&&d.cancel();d._options.autoSubmit&&d.submitForm()}else{j=d.pollStarted-+new Date;d.timer=setTimeout(function(){d._poll()},j<d._options.interval?d._options.interval:j);d.lastPoll=+new Date}}}}},error:function(j,q){if(!d.ended){d.pollRetries++;if(d.pollRetries>3){document.title=
d.documentTitle;d.ended=true;var h={error:"CONNECTION_ERROR",message:"There was a problem connecting to the upload server",reason:"JSONP request status: "+q};d.renderError(h);d._options.onError(h)}else setTimeout(function(){d._poll()},350)}}})}};a.prototype.stop=function(){document.title=this.documentTitle;this.ended=true};a.prototype.cancel=function(){if(!this.ended){var c=this;this.$params.prependTo(this.$form);this.$fileClones.each(function(d){d=b(c.$files[d]);var j=b(this);d.insertAfter(j);j.remove()});
clearTimeout(c.timer);this._poll("?method=delete");this.$iframe[0].contentWindow.stop();setTimeout(function(){c.$iframe.remove()},500)}if(this._options.modal){b.mask.close();this.$modal.remove()}};a.prototype.submitForm=function(){this.$fileClones.remove();b("<textarea/>").attr("name","transloadit").text(JSON.stringify(this.assembly)).prependTo(this.$form).hide();this.$form.unbind("submit.transloadit").submit()};a.prototype.showModal=function(){this.$modal=b('<div id="transloadit"><div class="content"><a href="#close" class="close"></a><p class="status"></p><div class="progress"><label>starting upload ...</label><span></span></div><p class="error"></p></div></div>').appendTo("body");
b.extend(this.$modal,{$status:this.$modal.find(".status"),$content:this.$modal.find(".content"),$close:this.$modal.find(".close"),$label:this.$modal.find("label"),$progress:this.$modal.find(".progress"),$progressSpan:this.$modal.find(".progress span"),$error:this.$modal.find(".error")});var c=this;this.$modal.$close.click(function(){c.cancel()});this.$modal.$error.hide();c=this;this.$modal.expose({api:true,maskId:"transloadit_expose",opacity:0.9,loadSpeed:250,closeOnEsc:false,closeOnClick:false}).load();
this.$modal.$close.click(function(){c.cancel();return false})};a.prototype.renderError=function(c){if(this._options.modal){this.$modal.$content.addClass("content-error");this.$modal.$progress.hide();this.$modal.$error.html(this._options.debug?c.error+": "+c.message+"<br><br>"+(c.reason||""):"There was an internal error, please try your upload again.").show()}};a.prototype.renderProgress=function(c){if(this._options.modal){var d=c.bytes_received/c.bytes_expected,j=c.bytes_received-this.bytesReceivedBefore,
q=+new Date-this.lastPoll,h=d==1?1E3:this._options.interval*2;j=d==1?"processing ...":(c.bytes_received/1024/1024).toFixed(2)+" MB / "+(c.bytes_expected/1024/1024).toFixed(2)+" MB ("+(j/1024/(q/1E3)).toFixed(1)+" kB / sec)";this.bytesReceivedBefore=c.bytes_received;this.$modal.$label.text(j);this.$modal.$progressSpan.stop().animate({width:d*100+"%"},h,"easeOutCubic")}};a.prototype.includeCss=function(){if(!(f||!this._options.modal)){f=true;b('<link rel="stylesheet" type="text/css" href="'+this._options.assets+
'css/transloadit2.css" />').appendTo("head")}};a.prototype.uuid=function(){var c="";for(i=0;i<32;i++)c+=Math.floor(Math.random()*16).toString(16);return c};a.prototype.options=function(c){if(arguments.length==0)return this._options;b.extend(this._options,c)};a.prototype.option=function(c,d){if(arguments.length==1)return this._options[c];this._options[c]=d}})(jQuery);